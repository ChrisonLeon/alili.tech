---
title: 利用ngrok给你的机器打个洞 - 内网穿透
tags: [Network]
slug: df8d5e8d
keywords: Network,网络,内网穿透,ngrok
date: 2018-09-12 00:00:00
---

我有很多自己的个人代码是跑在家里的服务器中的.一般来说都是自动化的处理我的一些生活问题,与数据收集等相关活动.
所以一般没有客户端访问家里服务器的需求.
但是很多时候脑子突发奇想.有一些小点子,一些小的bug或者小的优化,代码修改完成之后,有一个部署到需求.
因为家里服务器没有一个稳定的外网IP的,外网不能直接连接服务器.
所以我们需要 `内网穿透`.

# 内网穿透

家里用的是小米路由器,小米路由器里面集成了花生壳,理论上是可以做到内网穿透的.无奈的是,一直都没有配置成功过.

网上找过很多内网穿透的工具:
* 花生壳
* NAT
* frp
* ngrok
* localtunnel


## ngrok

选择ngrok的原因很简单,配置方便,并且支持tcp协议.
支持tcp协议代表,我可以直接在外面用SSH来访问家里的机器.

### 用法
1. 首先你需要去[官网](https://ngrok.com/)注册一个账号
2. 下载ngrok,并且解压到一个你喜欢的目录下面
3. 去官网复制你的授权码
4. 授权ngrok

```bash
ngrok authtoken 授权码
```

### http
```bash
ngrok http 8080
```

### tcp
```bash
ngrok tcp 22
```

![](https://ngrok.com/static/img/ngrok-demo-static.png)

最终你会得到,一个外网可以访问的地址.
用这个地址就可以直接访问到你本机的端口了.


当我们拥有这样一个公网地址之后,我们就可以ssh来控制家里的机器
或者使用github的webhook来做一切你想要做的事情.